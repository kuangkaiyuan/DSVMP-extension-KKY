\begin{abstract}
Code virtualization built upon virtual machine (VM) technologies is emerging
as a viable method for implementing code obfuscation to protect programs
against unauthorized analysis. State-of-the-art VM-based protection
approaches use a fixed scheduling structure where the program follows a
single, static execution path for the same input. Such approaches, however,
are vulnerable to certain scenarios where the attacker can reuse knowledge
extracted from previously seen software to crack applications using similar
protection schemes. This paper presents \DSVMP, a novel VM-based code
obfuscation approach for software protection. \DSVMP brings together two
techniques to provide stronger code protection than prior VM-based schemes.
Firstly, it uses a dynamic instruction scheduler to randomly direct the
program to execute different paths without violating the correctness across
different runs. By randomly choosing the program execution path, the
application exposes diverse behavior, making it much more difficult for an
attacker to reuse the knowledge collected from previous runs or similar
applications to perform attacks. Secondly, it employs multiple VMs to further
obfuscate the mapping from VM opcode to native machine instructions, so
that the same opcode could be mapped to different native instructions at runtime, making
code analysis even harder. We have implemented \DSVMP in a prototype system
and evaluated it using a set of widely used applications. Experimental
results show that \DSVMP provides stronger protection with comparable runtime
overhead and code size when compared to two commercial VM-based code
obfuscation tools.
\end{abstract} 